const spriteTable =
  "\
0234000000000000000000000000000000000000181811816666666d7777777644444444444444444444444444444444eeeeeeeeee1111ee11eeee11ee1111ee\
10700700000000000000000000000000ddd006dd181811816d1111d57666666d22244444222222224444444422211444ee1111eeee1111eeee1111eeee1111ee\
200000000000000000000000000000006d0000668118111165d11d557d6666dd24444422444444444444444424411422eeeeeeeeee1111ee1eeeeee1ee1111ee\
3007700000000000000000000000000007776760811881816d1111d57666666d444442242222222244444444444d1224ee1111eeee1111eeee1111eeee1111ee\
4007700000000000000000000000000006666660111111116dd11dd57666666d444444444444444444444444444d4444ee1111eeee1111eeee1111eeee1111ee\
507007000000000000000000000000006dd00dd6818188816dd11dd57666666d422244444444444444444444422d4444ee1111eeee1111eeee1111eeee1111ee\
60000000000000000000000000000000dd0000dd8881881165dddd557d6666dd44444444222222222222222244464444ee1111eeee1111eeee1111ee8eeeeee8\
700000000000000000000000000000000000000081818881d55555556ddddddd22222222222222222222222222262222ee1111eeee1111eeee1111ee88eeee88\
80000000000000000000000077777776222222224444444112211111555555554424424414444444111bb111444644446666666614444441eeeeeeee888e8ee8\
9000000000000000000000007000770d222222224444444121124111555555554424424414444444111331b1244644226666666614444441eeeeeeee888e8ee8\
a000000000000000000000007007700d4244444444444441114444210000000042244444144444441b13313122264444666666661444444111111111888e8ee8\
b000000000000000000000007077000d2444444444444441122444210000000042444442144444441313333144464114666666661446444111111111888e8ee8\
c000000000000000000000007770700d42444467444444412422422100000000424244421444444413333411444d1441666666661443444111111111888e8ee8\
d000000000000000000000007707000d2444444444444421244222110000000044424442124444441143341142ddd4417777777714b3344111111111188e8ee1\
e000000000000000000000007070000d2244444422222221124244210000000044444444122222221144441111444414dddddddd14bb3441eeeeeeee118e8e11\
f000000000000000000000006dddddd62444444222222211122122210000000044444244112222221122221122111122dddddddd14b33441eeeeeeee11111111\
44444441ffffffff111111111111111111111111111111114444444111111111eeeeeeeeeeeeeeee1111122222211111661111111444444111111166111dd111\
44444441f444444ffffff1111111111111111111111111114444444111111111eeeeeeeeeeeeeeee11112222222221116661111114444441111116661111d111\
44444441f4f4f4fff44ff111111111111444444444444411444444411111111188888888eeeeeeee112221d1d1d222116661111114444441111116661111d111\
22222221f4f4f4fff4ffffffffffffff1444444444444411222222211111111188888888ecc777ce1122d1d1d11d22116661111114444441111116661111d111\
d16161d1fffffffff4f4ff444444444f1444444444444411d16861d11111111188888888ec777cce022d1d1dd1d11220556111111444444111111655111dd111\
6161d1d144444444fff4ff4f4f4f4f4f14444444444444116868d9d11111111188888888e777ddde022011d22d1dd220665666111444444111666566111d1111\
61d1d1d142424244ff44ff4f4f4f4f4f122222222222221161d9d1d11111111188888888eeeeeeee022ddd2222d00220666666611444444116666666111d1111\
2222222144444444ffffff4f4f4f4f4f1d1d1d1d1d1616112222222111111111888888888888888802200d2222ddd220666666611444444116666666111d1111\
666666611111111144444fffffffffff1d1d1d16161717114444444111111111ffffffff00000000622dd6d22d66622666666661144444411666666611111111\
66666661ffffffff42224444444444441d161617b71717114444444111411441ffffffff0000000062266d6dd6d6d226556555611444444116555655111dd111\
6666666177777777422fffff222222241617c79717b616114444444114444144ff3fffff000000006622d66d6d6d226655566651144444411566655511dddd11\
ddddddd177777777444f4f4f2424242417c717a6b6b6bd112222222112424214ff3f3fff0000000066222d6d6d62226655566661144444411666655511dddd11\
51d1d151ffffffff111fffff4444444417c6c626b6bd2d11d16a61d122222411ff3f3fff000000006662222222226666555666611222222116666555115dd511\
d1d1515144444444111444441111111116c6262d2d2d2d11d9da6a6124424441ffffffff00000000777772222227777755566661122222211666655511155111\
d1515151411141441114222411111111162d2d2d2d2d2d11d1d9d16112422421ffffffff00000000dddddddddddddddd55555551111661111555555511111111\
ddddddd144444444111444441111111112222222222222112222222111211211ffffffff00000000dddddddddddddddd55555551111661111555555511111111\
000000000000000000000000000000000066d6000000000000000000000000000000000000000000055555500222222001111100022222200111110002222200\
000000000000000000000000000000000066d6000000000000000000000000000000000000000000576886752a9aa9a2167876102a9aa9a21678761029a9a920\
06000000060000000000000000ddd000000dd0000000000000000000000000000000000000000000578888752a2422a2168886102a9aa9a21688861029242920\
0066660000d666660446d6d6446664000d6666660000000000000000000000000000000000000000578888752a2422a2167876102ffffff21678761029a9a920\
046ddd00444504404440500044ddd4dd4d4440000000000000000000000000000000000000000000576886752ffffff217666710292922921766671024949420\
444500004400000044005000404050004405000000000000000000000000000000000000000000005d5dd5d52999999215ddd5102929229215ddd51024949420\
44000000000000000000000000405000000000000000000000000000000000000000000000000000055555500222222001111100022222200111110002222200\
00000000000000000000000000000500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000\
11111111222222221111111111111111222222221111111155555555444444445555555522222222444444445555552800000000000000000000000000000000\
1111111122222222111111111111111122222222112ee21155555555444444445555555522222222cd4444445555288800000000009aa90000000000008ee800\
115dd511222222221111111111288821222222221eeeee215567765544446776555eee5522222210cccd4444555288880000000009a77a900000000008e77e80\
17dddd51225335221111111112888882222222102eeeffe157777775444677775efffff2222220007cccd44455d888e7000000000a7777a0000000000e7777e0\
557d22d12333339a111111111822888892222100ee1ef0e1d677766d447777dd2fffff2222210000c77ccd4455667777000000000a7777a0000000000e7777e0\
157d882553333aaa1111111112678866aa92009aee1ee7e1ddd77ddd44777d0622ff22052100000070dc1114566777770000000009a77a900000000008e77e80\
11d8188d33339aa21111111116772666aaaaa0cce2127f7190077009446776065028e00549994000700c0111510aa77700000000009aa90000000000008ee800\
11d8188d3003a44211242111177066119aaa0c1cee11fff17909a097444977665f8888fe21109990777cc044d0a22a7000000000000000000000000000000000\
15dd88dd30139444994442111760566699aa0c1cee2100f1777997774499aa77f828828f2222a0001777764467a211a000422200000000007770000000000000\
53ddddd553333994a941422116000666e9909acc2ee000116799a977499a7777f2e22e2f2222a910117776446791199704277720002222000000000011110000\
33d3ddd1253333391a742222161006688e00aaa71ee001110719a16749a47777fffeeffe22227aa9c1777444678999774271f170028888207770000010010110\
3233d3512233333216777222111288882807777712ee21110600a017444477775feeeff52222777acc1764447788887724f1f1f028e888827770000011110110\
2223333122533372116777611128888225777777e11ee21101009006444d77775feeee2522267777cd71444477e88877427fff44288181827770000011111111\
2222232226557744411e1e111928882827777777ee12ee1100000010d6666777552eee2522267777d776444477788e7724777770282121820000000011111111\
62626226d66d554424e11e11aa8889a805777777ee21ee211000001066666677555eeee222277777777444447777777702477700282222820000000010011001\
6666626666666dd51224e421cca88caa00057777eee12ee110010000666666665552eeee22277777776444447777777700220220022222200000000001100110\
11115d1111113b111111111111288e1110001111111eeee111167711111167111111eef111000011dccccd111111888111d66dd5000000000000000011100000\
1115ddd1111333b111111111127078710779aa01111e7075116079a1111677711111f0ee1000000111c777c1117888811d6777dd000000000000000017110000\
11152dd111130aa111111111127770770c799990e111ee151167799a1116079951111ff100a70999111d707d167779aa6777776d000000000000000017711000\
5113dd7711133a991111441118870066077888892eeeee11100005191166777115544ff10000aa111111d771677077887772777d000000000000000017771000\
56623331dddd334111414691aa88881100770118122ee1111000005166666671545544e100077611cd7ccc71677777787728e776000000000000000017111000\
d566222116664441111461111baa821100000111117171110007000156666771feff4411000776111cd7c7616677776167787776000000000000000011100000\
1d666611116444111111111111cc2111100011111171711117700011157776111e11e11100776611117776111667761117777611000000000000000000000000\
118181111191911111111111115151111c1c11111121211111911911111e1e111e11e11100755001111515111191911111761111000000000000000000000000\
93939393939393939393939393939393939393939393939393939393939393939393939393939393939393939393939393939393939393939393939393939393\
93939393939393939393939393939393939393939393939393939393939393939393939393939393939393939393939393939393939393939393939393939393\
8282928282829282828292828282928282829282828292828282928282829282c0829282c0829282c0829282c082c08282c082929292929292929282c0829282\
82c08282c08282c08282c08282c09282828292828282928282829282828292828282928282829282828292828282928282829282828292828282928282829282\
61732232726102021212a161727272a172122290909090909090905272121212d0c1a0a0d0a0a0c1d0a0a0c1d0c3d02232d060c1c1c1c1c1c1c1c160d01272f2\
13d0c3c1d0c3c1d0c3c1d0c3c1d012f2727272727272727272727272727272f2727272727272727272727272727272f2727272727272727272727272727272f2\
7372233372727272727272727272727272132390909090909090905372020202d0727213d0727272d0727213d061d02333d0f28183838383838381f2d01272f2\
13d07272d07272d07272d07372d012f2727272727272727272727272727272f2727272727272727272727272727272f2727272727272727272727272727272f2\
727272727272727272727261d272727272727290909090909090907272720202d072f3d3d072f3d3d0d3f372d072d07272d0f28183838383838381f2d01272f2\
72d04182824182824182824182d012f2727272727272727272727272727272f2727272727272727272727272727272f2727272727272727272727272727272f2\
727372d2d2727272727273d173d3727272727272727272727272727272727202d0727272d0824182d0727272d073d07272d0f28183838383838381f2d01272f2\
72d07272727272727272727272d072f2727272720000007200007272727272f2727272720000007200000072727272f2727272720000007200000072727272f2\
727261d173d372727272726161727272727272727272727272727272727272728282418282a172a1828241828241827272d090909090909090909090d07272f2\
72d07272727272727272727272d072f2727272727272007272007272727272f2727272727272007272720072727272f2727272727272007272720072727272f2\
73727261d27272727372d3d261d37250727272c1a0a0a0a0a0a0c172727272727272727272727272727272727272727272d0a1a1727272727272f3d1d07272f2\
72d0a1727272727272727272a1d072f2727272720000007272007272727272f2727272720000007200000072727272f2727272720000007272000072727272f2\
7272d3d2d2d3727272727291517272727272d3d17272725072a1d272727272727272727272727272727272727272727272d0a1a1a1727272727272d3d07272f2\
728282828282824141828282828272f2727272720072727272007272727272f2727272720072727200727272727272f2727272720072727272720072727272f2\
72727291517272727272727272727261727272d2727272727272d1d37272727272727272c0824182c0824182c041c072728282828282828241418282827272f2\
72a112121272727272727272127272f2727272720000007200000072727272f2727272720000007200000072727272f2727272720000007200000072727272f2\
7272727272727272727272727272727272727291a0a0a0a0c1a051727272727272727202d0727291d0727272d012d002727272a11212223272722232727272f2\
727272727272727272727272727272f2727272727272727272727272727272f2727272727272727272727272727272f2727272727272727272727272727272f2\
72137272727272c272d172617272727272727272d37272d372d372727272727272720312d04272f3d0f3a0f3d012d012727272727272233372722333727272f2\
727272727272721272727272727272f2727272727272727272727272727272f2727272727272727272727272727272f2727272727272727272727272727272f2\
12121373127272c372d372e3727272a11272727272727272727272727272727272721362d0437212d072f312d013d012727272727272727272727272727272f2\
727272727272121213a17272727272f2727272727272727272727272727272f2727272727272727272727272727272f2727272727272727272727272727272f2\
82829282828292828282928282829282828292828282928282829282828292828282928282829282828292828282928282829282828292828282928282829282\
82829282828292828282928282829282828292828282928282829282828292828282928282829282828292828282928282829282828292828282928282829282\
93939393939393939393939393939393939393939393939393939393939393939393939393939393939393939393939393939393939393939393939393939393\
93939393939393939393939393939393939393939393939393939393939393939393939393939393939393939393939393939393939393939393939393939393\
c1c1c1c1c1c1c1c1c1c1c1c1c1c1c1c1c1c1c1c1c1c1c1c1c1c1c1c1c1c1c1c1c1c1c1c1c1c1c1c1c1c1c1c1c1c1c1c1c1c1c1c1c1c1c1c1c1c1c1c1c1c1c1c1\
c1c1c1c1c1c1c1c1c1c1c1c1c1c1c1c1c1c1c1c1c1c1c1c1c1c1c1c1c1c1c1c1c1c1c1c1c1c1c1c1c1c1c1c1c1c1c1c1c1c1c1c1c1c1c1c1c1c1c1c1c1c1c1c1\
93939393939393939393939393939393939393939393939393939393939393939393939393939393939393939393939393939393939393939393939393939393\
93939393939393939393939393939393939393939393939393939393939393939393939393939393939393939393939393939393939393939393939393939393\
8282928282c092828282928282829282828292828282928282829282828292828282928282829282828292828282928282829282828292828282928282829282\
828292828282928282829282828292828282928282829282828292828282928282829282828292828282928282829282c0829292929292c09393939393939393\
a1727272a1d0a1727272d2727272137272e2c272d1c272c1c172e2d172e2c272d0c2727272727272727272e2d04203f2c1c1a2b2c1c1c1a2b2c1c1c1a2b2c172\
13d0808080b080808080b0808080d0f2727272727272727272727272727272f2727272727272727272727272727272f2d0727272727272829292c09393939393\
c2d272d1e2d07272727291a0a0a0c1f272e3c372d3c372727272e3d372e3c3f2d0c3727272425272727272e3d04372f27270a3b370a170a3b370a170a3b37072\
02f0808080b180808080b1808080f0f2727272727272727272727272727272f2727272727272727272727272727272f2d07272727272727272728292c0939393\
c3d372d3e3d0727272727272727272f2727272727272727272727272727272f2d0a1727272435363127272a1d00272f272707070707270707070727070707072\
72f18080808080b0b08080808080f1f2727272727272727272727272727272f2727272727272727272727272727272f2d0727272727272727272727282319393\
7272727272d0137213e0c2d172d2e2f27272727272a172727272a172727272f2828241828282c08282824182827272f272f27272f272f27203f272f21202f272\
72a19080808080b1b18080808090a1f2727272720000007200000072727272f2727272720000007200000072727272f260727272727272727272727272319393\
72c2d1e272d02232a1d0c3d372d3e3f272637272d3d2f37250f3d1d3727262f2727272722232d00202037272727272f272f27272f272f27272f272f27213f272\
727272909090909090909090907272f2727272727272007200720072727272f2727272727272007200720072727272f272727272727272727272727272319393\
72c3d3e372d0233313d0a172727272f27262727272d1f37250f3d272727262f2727272722333d01203727272727272f272f22232f272f27272f272f27272f272\
727272727272727272727272727272f2727272720000007200000072727272f2727272720000007200720072727272f260727272727272727272727272319393\
7272727272f0721272d0c272d17272f272637272d3d272f3f372d2d3727263f2828241828282d08282824182827272f272f22333f272f27272f272f27272f272\
7272c272d172e27272c272d172e272f2727272720072727272720072727272f2727272727272007200720072727272f260727272727272727272727272319393\
7272727272f1727272d0c372d37272f2727272727291a0a0a0a05172727272f2d07272720262f0a172727272d07272f272f27272f272f21272f272f27272f272\
7272c372d372e37272c372d372e372f2727272720000007272720072727272f2727272720000007200000072727272f2c0727272727272727272727272319393\
727272727272727272d0a172727272f2727272727272727272727272727272f2d00372727272f17272727212d0a172f272c17272c1c1c11372c1c1c17203c172\
727272727272727250727272727272f2727272727272727272727272727272f2727272727272727272727272727272f2d07272727272727272727272c0829393\
223272727272727272d0c2d272d1e2f272e2c272d1c272727272e2d172e2c2f2d04202727272727272720363d02232f2e270f3f3e270c2f3f3e270c2f3f370c2\
727272727272727272727272727272f2727272727272727272727272727272f2727272727272727272727272727272f2d0727272727272727272c09282939393\
23331312a1727272a1d0c3d372d3e3f272e3c372d3c372c1c172e3d372e3c3f2d04362037272727272031362d02333f2e37013f3e370c3f3f3e370c3f31270c3\
727272c272d172e2c272d172e27272f2727272727272727272727272727272f2727272727272727272727272727272f2d0727272727272c09292829393939393\
82829282828292828282928282829282828292828282928282829282828292828282928282829282828292828282928282829282828292828282928282829282\
82829282828292828282928282829282828292828282928282829282828292828282928282829282828292828282928282829292929292829393939393939393\
93939393939393939393939393939393939393939393939393939393939393939393939393939393939393939393939393939393939393939393939393939393\
93939393939393939393939393939393939393939393939393939393939393939393939393939393939393939393939393939393939393939393939393939393\
c1c1c1c1c1c1c1c1c1c1c1c1c1c1c1c1c1c1c1c1c1c1c1c1c1c1c1c1c1c1c1c1c1c1c1c1c1c1c1c1c1c1c1c1c1c1c1c1c1c1c1c1c1c1c1c1c1c1c1c1c1c1c1c1\
c1c1c1c1c1c1c1c1c1c1c1c1c1c1c1c1c1c1c1c1c1c1c1c1c1c1c1c1c1c1c1c1c1c1c1c1c1c1c1c1c1c1c1c1c1c1c1c1c1c1c1c1c1c1c1c1c1c1c1c1c1c1c1c1\
";

export { spriteTable };

const paletteColors = [
  "#000000", "#1D2B53", "#7E2553", "#008751", "#AB5236", "#5F574F", "#C2C3C7", "#FFF1E8",
  "#FF004D", "#FFA300", "#FFEC27", "#00E436", "#29ADFF", "#83769C", "#FF77A8", "#FFCCAA"
];

export function hexToRGBArray(hex, alpha = 255) {
  if (!/^#[0-9a-fA-F]{6}$/.test(hex)) {
    throw new ColorFormatError(`Invalid hex color: ${hex}`);
  }

  const r = parseInt(hex.slice(1, 3), 16);
  const g = parseInt(hex.slice(3, 5), 16);
  const b = parseInt(hex.slice(5), 16);
  const a = alpha;

  return [r, g, b, a];
}

function getRGBArraysFromPalette(palette, zeroAlphaIndex = 0) {
  return palette.flatMap((color, index) => {
    const rgba = hexToRGBArray(color);
    if (index === zeroAlphaIndex) {
      rgba[3] = 0;
    }
    return rgba;
  });
}

const palette = new Uint8Array(getRGBArraysFromPalette(paletteColors, 1));
export { palette };


function convertSpritesheetToIndexArray(spriteSheet) {
  const spriteSize = 128 * 128
  const array = new Uint8Array(spriteSize);
  for (let i = 0; i < spriteSheet.length; i += 1) {
    const pixelHexa = spriteSheet.slice(i, i + 1);
    const pixel = parseInt(pixelHexa, 16);
    array[i] = (pixel);
  }
  return array;
}

export const spriteIndexed = convertSpritesheetToIndexArray(spriteTable)